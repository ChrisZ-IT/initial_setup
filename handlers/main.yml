---
- name: Reboot required
  ansible.builtin.reboot:
  register: reboot_result

- name: Wait for the reboot to complete
  ansible.builtin.wait_for_connection:
  when: reboot_result is changed
